<form [formGroup]="form" class="form">

	<div class="header-bar" [class.feature]="dtoBeforeUpdate?.type == 'feature'" [class.bug]="dtoBeforeUpdate?.type == 'bug'"
		[class.user-story]="dtoBeforeUpdate?.type == 'userStory'" [class.task]="dtoBeforeUpdate?.type == 'task'">
		<div *ngIf="!!dtoBeforeUpdate" class="monospace">
			<backlog-item-icon [type]="dtoBeforeUpdate.type"></backlog-item-icon>
			<span>{{typeTitle | uppercase}}</span>
		</div>
		<div class="flex-row title">
			<mat-form-field>
				<input type="text" matInput formControlName="title">
				<mat-placeholder>Title
					<sup class="color-warn">*</sup>
				</mat-placeholder>
				<mat-error>
					<error-messages formControlName="title"></error-messages>
				</mat-error>
			</mat-form-field>
		</div>
		<div class="title-secondary-block monospace">
			<div class="table narrow">
				<div class="row">
					<div class="label">Assignee:</div>
					<div class="control">
						<filter-single-select label="Not assigned" buttonAltText="Assigned to" formControlName="assigneeId"
							[narrowUnderscored]="true" [search]="searchByAssignee"></filter-single-select>
					</div>
				</div>
				<div class="row">
					<div class="label">State:</div>
					<div class="control">
						<filter-single-select label="State" buttonAltText="State" [options]="states" formControlName="state"
							[narrowUnderscored]="true" [hideClearButton]="true">
							<ng-template let-state>
								<backlog-item-state [state]="state"></backlog-item-state>
							</ng-template>
						</filter-single-select>
					</div>
				</div>
			</div>
			<div class="table wide">
				<div class="row">
					<div class="label">Tags:</div>
					<div class="control">
						<mat-form-field>
							<input type="email" matInput formControlName="tags">
							<mat-placeholder>Tags</mat-placeholder>
							<mat-error>
								<error-messages formControlName="tags"></error-messages>
							</mat-error>
						</mat-form-field>
					</div>
				</div>
				<div class="row">
					<div class="label">{{dtoBeforeUpdate?.comments?.length || 0}} comments</div>
				</div>
			</div>
		</div>
	</div>


	<div class="stretch">
		<button mat-stroked-button color="warn" (click)="delete()" *ngIf="!!editId">Delete</button>
		<div *ngIf="!editId"></div>
		<button mat-raised-button color="primary" (click)="save()" [disabled]="form.invalid">SAVE</button>
	</div>
</form>
&nbsp;
